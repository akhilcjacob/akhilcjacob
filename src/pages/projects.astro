---
import BasicLayout from "../layouts/BasicLayout.astro";
import "../styles/projects.css";

interface Project {
  title: string;
  description: string;
  tech: string[];
  appUrl?: string;
  landingPageUrl: string;
  screenshots: string[];
  videoUrl?: string;
  categories: string[];
  imageOpacity?: number;
  type: "web" | "mobile";
}

interface ProjectPair {
  name: string;
  projects: Project[];
  type: "web" | "mobile";
}

// Utility function to get YouTube video ID
function getYouTubeVideoId(url: string): string | null {
  const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
  const match = url.match(regExp);
  return match && match[2].length === 11 ? match[2] : null;
}

// Updated Project Data with new descriptions
const projectsData: ProjectPair[] = [
  {
    name: "HypeBridge",
    type: "web",
    projects: [
      {
        title: "HypeBridge Landing Page",
        description:
          "A cutting-edge platform that uses AI to automate influencer marketing. This landing page introduces the platform‚Äôs key benefits‚Äîstreamlining campaigns, discovering the perfect creators, and leveraging powerful analytics‚Äîall in one place.",
        tech: ["Next.js", "Marketing"],
        landingPageUrl: "https://thehypebridge.com",
        screenshots: ["https://thehypebridge.com/og-image.png"],
        categories: ["web"],
        type: "web",
      },
      {
        title: "HypeBridge",
        description:
          "A polished web app harnessing the power of AI to automate influencer marketing‚Äîfrom discovery to campaign management. Access robust analytics, manage campaigns seamlessly, and accelerate your brand growth.",
        tech: ["Next.js", "Marketing"],
        landingPageUrl: "https://thehypebridge.com",
        screenshots: ["https://thehypebridge.com/og-image.png"],
        videoUrl: "https://youtu.be/7TFqc2ty8yI",
        categories: ["web"],
        type: "web",
      },
    ],
  },
  {
    name: "inboxhiiv",
    type: "web",
    projects: [
      {
        title: "inboxhiiv Landing Page",
        description:
          "A forward-thinking landing page that showcases how newly released podcast episodes are instantly transformed into clean summaries and chapter breakdowns‚Äîdelivered right to your inbox.",
        tech: ["Next.js", "Marketing"],
        appUrl: "https://inboxhiiv.com",
        landingPageUrl: "https://inboxhiiv.com",
        screenshots: ["https://inboxhiiv.com/screenshots/dashboard.png"],
        categories: ["web"],
        type: "web",
      },
      {
        title: "inboxhiiv",
        description:
          "A revolutionary service that takes newly published podcast episodes and distills them into concise summaries and segmented breakdowns, conveniently emailed to you. Perfect for staying up-to-date without a major time commitment.",
        tech: ["Next.js", "Marketing"],
        appUrl: "https://inboxhiiv.com",
        landingPageUrl: "https://inboxhiiv.com",
        screenshots: ["/images/inboxhiiv_landing.png"],
        categories: ["web"],
        type: "web",
      },
    ],
  },
  {
    name: "Nookly",
    type: "web",
    projects: [
      {
        title: "Nookly",
        description:
          "A convenient Uber-styled platform for on-demand home services, connecting homeowners with reliable professionals in just a tap. Streamline your home maintenance and chores under one roof.",
        tech: ["Next.js", "Marketing"],
        appUrl: "https://nookly.co",
        landingPageUrl: "https://nookly.co",
        screenshots: ["/images/nookly_screenshot.png"],
        categories: ["mobile"],
        type: "mobile",
      },
      {
        title: "Nookly Landing Page",
        description:
          "A user-friendly landing page highlighting Nookly‚Äôs on-demand home service solutions. Discover how easy it is to book cleaning, handyman services, and more from one intuitive platform.",
        tech: ["Next.js", "Marketing"],
        appUrl: "https://nookly.co",
        landingPageUrl: "https://nookly.co",
        screenshots: [
          "https://nookly-web--nookly-39589.us-central1.hosted.app/og-image.png",
        ],
        categories: ["web"],
        type: "web",
      },
    ],
  },
  {
    name: "Skywise",
    type: "mobile",
    projects: [
      {
        title: "Skywise",
        description:
          "A next-generation weather app that combines accurate forecasts with AI-powered guidance. Ask questions and get personalized suggestions on what to wear or how best to plan your day.",
        tech: ["Next.js", "Marketing"],
        appUrl: "https://modrnmagic.app/skywise",
        landingPageUrl: "https://modrnmagic.app/skywise",
        screenshots: ["/images/skywise.png"],
        categories: ["mobile"],
        type: "mobile",
      },
      {
        title: "SkyWise Landing Page",
        description:
          "A refined landing page that highlights how Skywise leverages AI to make weather planning easier and more intuitive. Explore key features like conversational weather queries, personalized clothing tips, and more.",
        tech: ["Next.js", "Marketing"],
        appUrl: "https://nookly.co",
        landingPageUrl: "https://nookly.co",
        screenshots: ["/images/modrn.png"],
        categories: ["web"],
        type: "web",
      },
    ],
  },
  {
    name: "Flowmoro",
    type: "mobile",
    projects: [
      {
        title: "Flowmoro",
        description:
          "A sleek and modern Pomodoro app designed to keep you focused and productive. Break work into manageable intervals, track your progress, and build a healthier workflow.",
        tech: ["Next.js", "Marketing"],
        appUrl: "https://modrnmagic.app/flowmoro",
        landingPageUrl: "https://modrnmagic.app/flowmoro",
        screenshots: ["https://modrnmagic.app/apps/flowmoro/screenshots/1.png"],
        categories: ["mobile"],
        type: "mobile",
      },
      {
        title: "Flowmoro Landing Page",
        description:
          "A beautifully crafted landing page showcasing Flowmoro‚Äôs productivity-boosting Pomodoro features. Learn how structured work sprints can optimize efficiency and well-being.",
        tech: ["Next.js", "Marketing"],
        appUrl: "https://nookly.co",
        landingPageUrl: "https://nookly.co",
        screenshots: ["/images/flowmoro_landing.png"],
        categories: ["web"],
        type: "web",
      },
    ],
  },
];

// Hardcoded list for landing page marquee
const landingPages = [
  {
    url: "/images/modrn.png",
    name: "Skywise",
    type: "web",
    appUrl: "https://modrnmagic.app/skywise"
  },
  {
    url: "/images/inboxhiiv_landing.png",
    name: "inboxhiiv",
    type: "web",
    appUrl: "https://inboxhiiv.com"
  },
  {
    url: "/images/flowmoro_landing.png",
    name: "Flowmoro",
    type: "web",
    appUrl: "https://modrnmagic.app/flowmoro"
  },
  {
    url: "https://thehypebridge.com/og-image.png",
    name: "HypeBridge",
    type: "web",
    appUrl: "https://thehypebridge.com"
  },
];

// Duplicate the array to create a seamless loop
const landingPagesLoop = [...landingPages, ...landingPages];
---

<BasicLayout>
  <div class="relative min-h-screen w-full overflow-y-auto">
    <!-- Background effect -->
    <div class="fixed inset-0 z-0">
      <div
        class="absolute inset-0 bg-[radial-gradient(ellipse_80%_80%_at_50%_-20%,rgba(65,105,225,0.15),rgba(30,144,255,0.08),rgba(10,10,10,0.95))]"
      >
      </div>
      <div
        class="absolute inset-0 bg-gradient-to-b from-[#4169E1]/5 via-transparent to-transparent"
      >
      </div>
      <div
        class="absolute inset-0 bg-[url('/noise.png')] opacity-25 mix-blend-soft-light"
      >
      </div>
      <div
        class="absolute inset-0"
        style="background-image: linear-gradient(rgba(65,105,225,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(65,105,225,0.03) 1px, transparent 1px); background-size: 32px 32px;"
      >
      </div>
      <div
        class="absolute top-0 left-1/4 w-[500px] h-[500px] bg-[#4169E1] opacity-[0.15] blur-[128px] rounded-full"
      >
      </div>
      <div
        class="absolute bottom-0 right-1/4 w-[400px] h-[400px] bg-[#1E90FF] opacity-[0.15] blur-[96px] rounded-full"
      >
      </div>
    </div>

    <!-- Sticky CTA Bar -->
    <div
      class="sticky top-0 z-50 w-full backdrop-blur-md bg-black/30 border-b border-white/10"
    >
      <div
        class="container mx-auto px-4 py-3 flex justify-between items-center"
      >
        <div class="text-white/80 text-sm md:text-base">
          Ready to build your next digital product?
        </div>
        <div class="flex gap-4">
          <a href="#contact" class="glass-button-sm primary">Work with Me ‚Üí</a>
        </div>
      </div>
    </div>

    <div class="container mx-auto px-4 py-16 relative z-10">
      <!-- Hero Section with Enhanced Marquee -->
      <section
        class="relative min-h-screen flex flex-col items-center justify-center text-center animate-fade"
      >
        <div class="relative z-10 mb-32">
          <h1 class="text-6xl md:text-7xl font-bold text-white mb-6">
            Crafting Digital Experiences
          </h1>
          <p class="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto mb-12">
            From concept to launch, I build complete digital products. Each
            project comes with both a powerful app and a beautiful landing page.
          </p>
          <div class="flex flex-col md:flex-row gap-6 justify-center">
            <a href="#contact" class="glass-button primary">
              Start Your Project ‚Üí
            </a>
            <a href="#featured-work" class="glass-button secondary">
              View My Work
            </a>
          </div>
        </div>

        <!-- Enhanced Landing Page Marquee -->
        <div class="absolute bottom-0 left-0 right-0 h-80 overflow-hidden">
          <div class="marquee-container">
            <div class="marquee marquee-landing">
              {
                landingPagesLoop.map((item) => (
                  <a
                    href={item.appUrl}
                    target="_blank"
                    class="marquee-item-landing"
                  >
                    <div class="landing-image-container">
                      <img
                        src={item.url}
                        alt={`${item.name} landing page`}
                        class="rounded-xl shadow-2xl"
                      />
                      <div class="marquee-overlay glass-card">
                        <span class="text-lg font-medium">{item.name}</span>
                      </div>
                    </div>
                  </a>
                ))
              }
            </div>
          </div>
        </div>
      </section>

      <!-- Services Section -->
      <section
        class="min-h-screen flex items-center justify-center py-24 animate-fade"
      >
        <div class="w-full">
          <div class="text-center mb-16">
            <h2 class="text-4xl md:text-5xl font-bold text-white mb-6">
              Your Vision, Delivered
            </h2>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto">
              I specialize in turning ideas into polished digital products,
              combining powerful functionality with stunning design.
            </p>
          </div>

          <div class="grid md:grid-cols-2 gap-8 max-w-6xl mx-auto">
            <div class="glass-card-service p-8 relative overflow-hidden group">
              <div class="relative z-10">
                <div class="text-3xl mb-6">üöÄ</div>
                <h3 class="text-2xl font-bold text-white mb-4">
                  Web Applications
                </h3>
                <ul class="space-y-3 text-gray-300 mb-8">
                  <li class="flex items-center gap-2">
                    <span class="text-blue-400">‚úì</span> Full-featured web application
                  </li>
                  <li class="flex items-center gap-2">
                    <span class="text-blue-400">‚úì</span> Modern, responsive landing
                    page
                  </li>
                  <li class="flex items-center gap-2">
                    <span class="text-blue-400">‚úì</span> Authentication & core features
                  </li>
                  <li class="flex items-center gap-2">
                    <span class="text-blue-400">‚úì</span> 4-6 weeks delivery
                  </li>
                </ul>
                <a href="#contact" class="glass-button-sm primary"
                  >Get Started ‚Üí</a
                >
              </div>
              <div
                class="absolute inset-0 bg-gradient-to-br from-blue-500/10 to-purple-500/10 transform group-hover:scale-105 transition-transform duration-500"
              >
              </div>
            </div>

            <div class="glass-card-service p-8 relative overflow-hidden group">
              <div class="relative z-10">
                <div class="text-3xl mb-6">üì±</div>
                <h3 class="text-2xl font-bold text-white mb-4">
                  Mobile Applications
                </h3>
                <ul class="space-y-3 text-gray-300 mb-8">
                  <li class="flex items-center gap-2">
                    <span class="text-blue-400">‚úì</span> Native iOS/Android app
                  </li>
                  <li class="flex items-center gap-2">
                    <span class="text-blue-400">‚úì</span> Professional landing page
                  </li>
                  <li class="flex items-center gap-2">
                    <span class="text-blue-400">‚úì</span> App store submission
                  </li>
                  <li class="flex items-center gap-2">
                    <span class="text-blue-400">‚úì</span> 4-6 weeks delivery
                  </li>
                </ul>
                <a href="#contact" class="glass-button-sm primary"
                  >Get Started ‚Üí</a
                >
              </div>
              <div
                class="absolute inset-0 bg-gradient-to-br from-purple-500/10 to-pink-500/10 transform group-hover:scale-105 transition-transform duration-500"
              >
              </div>
            </div>
          </div>

          <div class="text-center mt-16">
            <a href="#contact" class="glass-button primary">
              Start Your Project ‚Üí
            </a>
          </div>
        </div>
      </section>

      <!-- NEW "About / Philosophy / Approach" SECTION -->
      <section class="py-24 animate-fade">
        <div class="max-w-4xl mx-auto px-4">
          <h2 class="text-4xl md:text-5xl font-bold text-white text-center mb-8">
            Need Design That Really Reflects Who You Are?
          </h2>
          <p class="text-xl text-gray-300 text-center max-w-3xl mx-auto mb-12">
            My job isn‚Äôt just about making things look good‚Äîit‚Äôs about capturing 
            the essence of your brand and translating that into a powerful, 
            memorable experience for your audience. I believe that truly 
            successful design resonates deeply with the people it‚Äôs meant for.
          </p>
        </div>

        <div class="flex items-center justify-center mb-16">
          <img
            src="/images/abstract-flower.png"
            alt="Abstract design element"
            class="w-80 h-80 opacity-70"
          />
        </div>

        <div class="max-w-5xl mx-auto px-4">
          <div class="text-center">
            <h3 class="text-3xl md:text-4xl font-bold text-white mb-6">
              My Approach
            </h3>
            <p class="text-lg text-gray-300 max-w-3xl mx-auto mb-8">
              Every design starts with a thorough understanding of your goals, 
              audience, and brand personality. By focusing on strategy first, I 
              ensure that the creative direction aligns perfectly with your 
              vision. This way, you end up with a final product that‚Äôs not just 
              visually stunning, but genuinely meaningful to your users.
            </p>
          </div>
        </div>
      </section>

      <!-- NEW TESTIMONIAL SECTION -->
      <section class="py-24">
        <div class="glass-card-lg max-w-4xl mx-auto p-8">
          <div class="flex flex-col items-center">
            <img
              src="/images/testimonial-person.jpg"
              alt="Client headshot"
              class="w-20 h-20 rounded-full mb-6"
            />
            <blockquote class="text-xl italic text-center text-gray-300 leading-relaxed max-w-3xl">
              ‚ÄúMarc is one of the most precious in our industry;
              the way he approaches projects is an inspiration. 
              He truly cares about every detail, from the UX to the final polish 
              on the landing page. We couldn‚Äôt be happier with our results!‚Äù
            </blockquote>
            <p class="mt-4 text-gray-400">‚Äî Sarah P, Founder at WellnessCo</p>
          </div>
        </div>
      </section>

      <!-- OPTIONAL: A ‚ÄúHow it Works‚Äù / ‚ÄúProcess‚Äù Section -->
      <section class="py-24 animate-fade">
        <div class="max-w-5xl mx-auto px-4 text-center">
          <h2 class="text-4xl md:text-5xl font-bold text-white mb-8">
            How do things work?
          </h2>
          <p class="text-xl text-gray-300 max-w-3xl mx-auto mb-12">
            Let‚Äôs break down my process into a few simple steps so you know exactly 
            what to expect when we collaborate.
          </p>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- Step 1 -->
            <div class="p-8 glass-card-service">
              <h3 class="text-2xl font-bold text-white mb-4">1. Exploration</h3>
              <p class="text-gray-300">
                We‚Äôll talk about your goals, target audience, and brand identity.
                Think of it as a deep dive that helps us uncover what truly 
                matters for your project.
              </p>
            </div>

            <!-- Step 2 -->
            <div class="p-8 glass-card-service">
              <h3 class="text-2xl font-bold text-white mb-4">2. Strategy & Design</h3>
              <p class="text-gray-300">
                Based on our insights, I‚Äôll craft a design strategy and produce 
                wireframes or prototypes, ensuring every detail aligns with your 
                brand‚Äôs essence.
              </p>
            </div>

            <!-- Step 3 -->
            <div class="p-8 glass-card-service">
              <h3 class="text-2xl font-bold text-white mb-4">3. Build & Launch</h3>
              <p class="text-gray-300">
                Once the design is approved, I‚Äôll build out your product‚Äîwhether 
                that‚Äôs a web app, mobile app, or marketing site‚Äîand help ensure a 
                smooth launch from day one.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Featured Work Section -->
      <section id="featured-work" class="py-24 animate-fade">
        <h2 class="text-4xl md:text-5xl font-bold text-white text-center mb-16">
          Featured Work
        </h2>

        <div class="space-y-32">
          {
            projectsData.map((projectPair) => (
              <div class="project-showcase">
                <h3 class="text-3xl font-bold text-white mb-8">
                  {projectPair.name}
                </h3>

                {projectPair.projects.map((project) => (
                  <div class="glass-card-project mb-16">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                      {/* Project Info */}
                      <div
                        class={`project-info ${project.type === "mobile" ? "lg:order-2" : ""}`}
                      >
                        <h4 class="text-2xl font-semibold text-white mb-4">
                          {project.title}
                        </h4>
                        <p class="text-gray-300 mb-6">{project.description}</p>

                        <div class="flex flex-wrap gap-2 mb-6">
                          {project.tech.map((tech) => (
                            <span class="glass-pill">{tech}</span>
                          ))}
                        </div>

                        <div class="flex gap-4">
                          {project.appUrl && (
                            <a
                              href={project.appUrl}
                              target="_blank"
                              class="glass-button primary"
                            >
                              View{" "}
                              {project.type === "mobile" ? "App" : "Web App"} ‚Üí
                            </a>
                          )}
                          <a
                            href={project.landingPageUrl}
                            target="_blank"
                            class="glass-button secondary"
                          >
                            Landing Page ‚Üí
                          </a>
                        </div>
                      </div>

                      {/* Project Screenshots or Video */}
                      <div
                        class={`project-screenshots ${project.type === "mobile" ? "lg:order-1" : ""}`}
                      >
                        <div
                          class={`screenshot-container ${project.type === "mobile" ? "mobile-screenshots" : "web-screenshots"}`}
                        >
                          {project.videoUrl ? (
                            // YouTube Video Embed
                            <div class="web-shot glass-card relative">
                              <iframe
                                width="100%"
                                height="315"
                                src={`https://www.youtube.com/embed/${getYouTubeVideoId(project.videoUrl)}`}
                                title={`${project.title} demo video`}
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen
                                class="rounded-lg relative z-10"
                                style="pointer-events: auto;"
                              />
                            </div>
                          ) : project.type === "mobile" ? (
                            // Mobile app view
                            <div class="mobile-app-container">
                              {project.screenshots.map((screenshot, index) => (
                                <div class="mobile-shot">
                                  <img
                                    src={screenshot}
                                    alt={`${project.title} screenshot ${index + 1}`}
                                    class="mobile-image"
                                    style={
                                      project.imageOpacity
                                        ? `opacity: ${project.imageOpacity / 100}`
                                        : ""
                                    }
                                  />
                                </div>
                              ))}
                            </div>
                          ) : (
                            // Web project view - show landing page
                            <div class="web-shot glass-card">
                              <div class="relative w-full h-0 pb-[56.25%]">
                                <img
                                  src={project.screenshots[0]}
                                  alt={`${project.title} landing page`}
                                  class="web-image absolute top-0 left-0 w-full h-full object-contain"
                                  style={
                                    project.imageOpacity
                                      ? `opacity: ${project.imageOpacity / 100}`
                                      : ""
                                  }
                                />
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            ))
          }
        </div>
      </section>

      <!-- Contact Section -->
      <section id="contact" class="py-24">
        <div class="glass-card-lg max-w-3xl mx-auto p-12">
          <h2
            class="text-4xl md:text-5xl font-bold text-white text-center mb-6"
          >
            Let's Build Something Amazing
          </h2>
          <p class="text-xl text-gray-300 mb-12 text-center">
            Share your vision and I'll help bring it to life.
          </p>

          <form id="contact-form" class="contact-form">
            <div class="form-group">
              <label for="name" class="form-label">Your Name</label>
              <input
                type="text"
                id="name"
                name="name"
                class="form-input"
                placeholder="John Doe"
                required
              />
            </div>

            <div class="form-group">
              <label for="email" class="form-label">Email Address</label>
              <input
                type="email"
                id="email"
                name="email"
                class="form-input"
                placeholder="john@example.com"
                required
              />
            </div>

            <div class="form-group">
              <label for="project-type" class="form-label">Project Type</label>
              <div class="project-type-options">
                <label class="project-type-option">
                  <input type="checkbox" name="project-type" value="web-app" />
                  <span>Web App</span>
                </label>
                <label class="project-type-option">
                  <input
                    type="checkbox"
                    name="project-type"
                    value="mobile-app"
                  />
                  <span>Mobile App</span>
                </label>
                <label class="project-type-option">
                  <input
                    type="checkbox"
                    name="project-type"
                    value="landing-page"
                  />
                  <span>Landing Page</span>
                </label>
                <label class="project-type-option">
                  <input
                    type="checkbox"
                    name="project-type"
                    value="other"
                    class="other-checkbox"
                    data-target="other-project-type"
                  />
                  <span>Other</span>
                </label>
              </div>
              <input
                type="text"
                id="other-project-type"
                name="other-project-type"
                class="form-input mt-3 hidden"
                placeholder="Please specify your project type"
              />
            </div>

            <div class="form-group">
              <label for="budget" class="form-label">Budget Range</label>
              <select id="budget" name="budget" class="form-input" required>
                <option value="">Select a budget range</option>
                <option value="5k-10k">$5,000 - $10,000</option>
                <option value="10k-25k">$10,000 - $25,000</option>
                <option value="25k-50k">$25,000 - $50,000</option>
                <option value="50k+">$50,000+</option>
                <option value="other">Other (Please specify)</option>
              </select>
              <input
                type="text"
                id="other-budget"
                name="other-budget"
                class="form-input mt-3 hidden"
                placeholder="Please specify your budget range"
              />
            </div>

            <div class="form-group">
              <label for="timeline" class="form-label">Desired Timeline</label>
              <select id="timeline" name="timeline" class="form-input" required>
                <option value="">Select a timeline</option>
                <option value="1-2-weeks">1-2 weeks</option>
                <option value="1-2-months">1-2 months</option>
                <option value="2-4-months">2-4 months</option>
                <option value="4-6-months">4-6 months</option>
                <option value="6-plus-months">6+ months</option>
                <option value="other">other</option>
              </select>
            </div>

            <div class="form-group">
              <label for="message" class="form-label">Project Details</label>
              <textarea
                id="message"
                name="message"
                class="form-textarea"
                placeholder="Tell me about your project idea, specific features you'd like to include, and any other important details."
                required></textarea>
            </div>

            <button type="submit" class="glass-button primary w-full">
              Send Message ‚Üí
            </button>
          </form>
        </div>
      </section>

      <script
        type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"
      ></script>

      <script>
        (function () {
          emailjs.init("vS3CR-R0Bjl5BLllJ");
        })();

        const form = document.getElementById("contact-form");

        // Handle "Other" option visibility
        document
          .querySelector('input[value="other"].other-checkbox')
          .addEventListener("change", function (e) {
            const otherInput = document.getElementById(this.dataset.target);
            otherInput.classList.toggle("hidden", !this.checked);
            if (this.checked) {
              otherInput.required = true;
            } else {
              otherInput.required = false;
              otherInput.value = "";
            }
          });

        // Handle budget "Other" option
        document
          .getElementById("budget")
          .addEventListener("change", function (e) {
            const otherBudgetInput = document.getElementById("other-budget");
            otherBudgetInput.classList.toggle("hidden", this.value !== "other");
            if (this.value === "other") {
              otherBudgetInput.required = true;
            } else {
              otherBudgetInput.required = false;
              otherBudgetInput.value = "";
            }
          });

        form.addEventListener("submit", async function (e) {
          e.preventDefault();

          const button = form.querySelector('button[type="submit"]');
          const originalContent = button.innerHTML;
          button.disabled = true;
          button.innerHTML =
            '<svg class="w-5 h-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';

          const formData = {
            name: form.querySelector("#name").value,
            email: form.querySelector("#email").value,
            projectType: Array.from(
              form.querySelectorAll('input[name="project-type"]:checked'),
            ).map((input) => {
              if (input.value === "other") {
                return `Other: ${form.querySelector("#other-project-type").value}`;
              }
              return input.value;
            }),
            budget:
              form.querySelector("#budget").value === "other"
                ? `Other: ${form.querySelector("#other-budget").value}`
                : form.querySelector("#budget").value,
            timeline: form.querySelector("#timeline").value,
            message: form.querySelector("#message").value,
          };

          try {
            const response = await emailjs.send(
              "service_lh7iqlh",
              "template_r1vw5j2",
              {
                from_name: formData.name,
                from_email: formData.email,
                project_type: formData.projectType.join(", "),
                budget: formData.budget,
                timeline: formData.timeline,
                message: formData.message,
                to_name: "Akhil",
                to_email: "akhil@modrnmagic.app",
              },
            );

            if (response.status === 200) {
              // Show success message
              const successMessage = document.createElement("div");
              successMessage.className =
                "fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform transition-all duration-500 translate-y-0 z-50";
              successMessage.innerHTML = `
                        <div class="flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span>Thanks! I'll get back to you shortly.</span>
                        </div>
                    `;
              document.body.appendChild(successMessage);

              setTimeout(() => {
                successMessage.style.transform = "translateY(-100%)";
                setTimeout(() => successMessage.remove(), 500);
              }, 5000);

              form.reset();
            }
          } catch (error) {
            console.error("Error:", error);
            const errorMessage = document.createElement("div");
            errorMessage.className =
              "fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg transform transition-all duration-500 translate-y-0 z-50";
            errorMessage.innerHTML = `
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                        <span>Oops! Something went wrong. Please try again.</span>
                    </div>
                `;
            document.body.appendChild(errorMessage);

            setTimeout(() => {
              errorMessage.style.transform = "translateY(-100%)";
              setTimeout(() => errorMessage.remove(), 500);
            }, 5000);
          } finally {
            // Restore the original button content and enable it
            button.innerHTML = originalContent;
            button.disabled = false;
          }
        });
      </script>
    </div>
  </div>
</BasicLayout>
